---
name: master-recovery
description: æŒ‚èµ·ä»»åŠ¡æ¢å¤æµç¨‹ã€‚Master Agent å¤„ç† blocked_reason.md æ—¶è°ƒç”¨ã€‚
---

# æŒ‚èµ·ä»»åŠ¡æ¢å¤æµç¨‹

## è§¦å‘æ¡ä»¶

- æ”¶åˆ° `[BLOCK_NEED_MASTER]` æ ‡ç­¾
- éœ€è¦å¤„ç†æŒ‚èµ·ä»»åŠ¡

## æ‰§è¡Œæµç¨‹

### 1. è¯»å–é˜»å¡åŸå› 

```
è¯»å– `.trae/blocked_reason.md` è·å–é˜»å¡è¯¦æƒ…
```

### 2. åˆ¤æ–­åŸå› ç±»å‹

æ ¹æ® `reason_type` å­—æ®µåˆ¤æ–­æ¢å¤ç­–ç•¥ï¼š

| reason_type | å«ä¹‰ | æ¢å¤ç­–ç•¥ |
|-------------|------|----------|
| `missing_context` | ç¼ºå°‘ DOM ç»“æ„ç­‰ä¸Šä¸‹æ–‡ | è°ƒç”¨ test-agent å—…æ¢ï¼Œæºæ–°æ•°æ®é‡è¯• |
| `logic_unimplementable` | æ ¸å¿ƒé€»è¾‘æ— æ³•å®ç° | åœæ­¢æµè½¬ï¼Œäº¤å‡ºæ§åˆ¶æƒç»™äººç±» |
| `mcp_failure` | MCP è°ƒç”¨è¿ç»­å¤±è´¥ | æ£€æŸ¥ MCP é…ç½®ï¼Œäººå·¥å¹²é¢„ |
| `retry_exhausted` | é‡è¯•æ¬¡æ•°è€—å°½ï¼ˆç†”æ–­è§¦å‘ï¼‰ | äººå·¥å®¡æŸ¥åå†³å®šæ˜¯å¦ç»§ç»­ |

## æ¢å¤ç­–ç•¥è¯¦è§£

### ç­–ç•¥ 1ï¼šmissing_contextï¼ˆç¼ºå°‘ä¸Šä¸‹æ–‡ï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

1. è¯»å– `blocked_reason.md` ä¸­çš„"éœ€è¦çš„ä¿¡æ¯"éƒ¨åˆ†
2. è°ƒç”¨ test-agent å•ç‹¬æ‰§è¡Œ Playwright å—…æ¢æ“ä½œï¼ˆä¸è¿è¡Œå…¨é‡æµ‹è¯•ï¼‰
3. è·å– DOM ç»“æ„æˆ–é€‰æ‹©å™¨ä¿¡æ¯
4. æ›´æ–° `current_task.md`ï¼Œæ·»åŠ æ–°è·å–çš„ä¸Šä¸‹æ–‡
5. é‡æ–°å”¤é†’ dev-agent

**å—…æ¢å‘½ä»¤**ï¼š

```bash
# ä»…æ‰§è¡Œé¡µé¢å—…æ¢ï¼Œä¸è¿è¡Œå®Œæ•´æµ‹è¯•
python -c "
from playwright.sync_api import sync_playwright
with sync_playwright() as p:
    browser = p.chromium.launch(headless=True)
    page = browser.new_page()
    page.goto('<ç›®æ ‡URL>')
    # è·å– Accessibility Tree
    snapshot = page.accessibility.snapshot()
    print(snapshot)
    browser.close()
"
```

### ç­–ç•¥ 2ï¼šlogic_unimplementableï¼ˆæ ¸å¿ƒé€»è¾‘æ— æ³•å®ç°ï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

1. åœ¨ç»ˆç«¯è¾“å‡ºé˜»æ–­æ—¥å¿—
2. åœæ­¢ä»»åŠ¡æµè½¬
3. å½»åº•äº¤å‡ºæ§åˆ¶æƒç»™äººç±»

**è¾“å‡ºæ ¼å¼**ï¼š

```
========================================
âš ï¸ ä»»åŠ¡é˜»æ–­é€šçŸ¥
========================================
ä»»åŠ¡ID: <task_id>
é˜»æ–­åŸå› : æ ¸å¿ƒé€»è¾‘æ— æ³•å®ç°
å·²å°è¯•æ–¹æ¡ˆ:
  1. <æ–¹æ¡ˆ 1>
  2. <æ–¹æ¡ˆ 2>
  3. <æ–¹æ¡ˆ 3>
Traceback:
  <æœ€å 10 è¡Œé”™è¯¯å †æ ˆ>
========================================
è¯·äººå·¥å®¡æŸ¥åå†³å®šæ˜¯å¦ç»§ç»­ä»»åŠ¡ã€‚
å¦‚éœ€ç»§ç»­ï¼Œè¯·é‡ç½® dev_retry_count å¹¶é‡æ–°åˆ†å‘ä»»åŠ¡ã€‚
========================================
```

### ç­–ç•¥ 3ï¼šmcp_failureï¼ˆMCP è°ƒç”¨å¤±è´¥ï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

1. æ£€æŸ¥ MCP é…ç½®æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. è¾“å‡ºè¯Šæ–­ä¿¡æ¯
4. ç­‰å¾…äººå·¥å¹²é¢„

**è¯Šæ–­å‘½ä»¤**ï¼š

```bash
# æ£€æŸ¥ Playwright MCP
python -c "from playwright.sync_api import sync_playwright; print('Playwright OK')"

# æ£€æŸ¥ Memory MCP
# ï¼ˆé€šè¿‡ MCP å·¥å…·æµ‹è¯•ï¼‰

# æ£€æŸ¥ GitHub MCP
gh repo view Disaster-Terminator/RewardsCore
```

### ç­–ç•¥ 4ï¼šretry_exhaustedï¼ˆé‡è¯•è€—å°½ï¼‰

**æ‰§è¡Œæ­¥éª¤**ï¼š

1. è¾“å‡ºç†”æ–­é€šçŸ¥
2. ç­‰å¾…äººå·¥å®¡æŸ¥
3. æ ¹æ®äººå·¥å†³å®šï¼š
   - ç»§ç»­ä»»åŠ¡ï¼šé‡ç½® `dev_retry_count: 0`ï¼Œé‡æ–°åˆ†å‘
   - æ”¾å¼ƒä»»åŠ¡ï¼šæ¸…ç†åª’ä»‹æ–‡ä»¶ï¼Œç»“æŸä»»åŠ¡

**è¾“å‡ºæ ¼å¼**ï¼š

```
========================================
ğŸ”´ ç†”æ–­å™¨è§¦å‘é€šçŸ¥
========================================
ä»»åŠ¡ID: <task_id>
é‡è¯•æ¬¡æ•°: <dev_retry_count> / <max_retries>
é˜»æ–­åŸå› : é‡è¯•æ¬¡æ•°è€—å°½

å†å²å¤±è´¥è®°å½•:
  è½®æ¬¡ 1: <å¤±è´¥åŸå› >
  è½®æ¬¡ 2: <å¤±è´¥åŸå› >
  è½®æ¬¡ 3: <å¤±è´¥åŸå› >

è¯·äººå·¥å®¡æŸ¥åå†³å®šï¼š
  1. ç»§ç»­ä»»åŠ¡ï¼šé‡ç½® dev_retry_count å¹¶é‡æ–°åˆ†å‘
  2. æ”¾å¼ƒä»»åŠ¡ï¼šæ¸…ç†åª’ä»‹æ–‡ä»¶å¹¶ç»“æŸ
========================================
```

## äººå·¥å¹²é¢„åæ¢å¤

### ç»§ç»­ä»»åŠ¡

1. é‡ç½® `dev_retry_count: 0`
2. æ›´æ–° `current_task.md` ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
3. é‡æ–°åˆ†å‘ä»»åŠ¡

```yaml
---
task_id: <ä»»åŠ¡ID>
dev_retry_count: 0  # é‡ç½®
max_retries: 3
status: pending
---
```

### æ”¾å¼ƒä»»åŠ¡

1. æ¸…ç†åª’ä»‹æ–‡ä»¶
2. è®°å½•æ”¾å¼ƒåŸå› 

```bash
# æ¸…ç†åª’ä»‹æ–‡ä»¶
echo "---\nstatus: abandoned\n---" > .trae/current_task.md
```

## è¾“å‡ºæ ¼å¼

### æ¢å¤æˆåŠŸ

```markdown
---
task_id: <ä»»åŠ¡ID>
status: recovered
recovery_type: <missing_context | mcp_failure>
---

### æ¢å¤æ“ä½œ

- è·å–çš„ä¸Šä¸‹æ–‡ï¼š<æè¿°>
- ä¸‹ä¸€æ­¥ï¼šé‡æ–°å”¤é†’ dev-agent
```

### éœ€è¦äººå·¥å¹²é¢„

```markdown
---
task_id: <ä»»åŠ¡ID>
status: human_required
reason_type: <logic_unimplementable | retry_exhausted>
---

### é˜»æ–­ä¿¡æ¯

<é˜»æ–­è¯¦æƒ…>

### äººå·¥æ“ä½œå»ºè®®

<å»ºè®®çš„äººå·¥æ“ä½œ>
```

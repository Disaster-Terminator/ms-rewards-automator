# 任务：统一配置格式 (fix/config-consistency)

## 背景

项目中 `wait_interval` 配置格式存在不一致问题，需要统一为 `{min, max}` 字典格式。

## 问题清单

| 文件 | 当前格式 | 目标格式 |
|------|----------|----------|
| `config.example.yaml:10` | `wait_interval: 5` | `wait_interval: {min: 5, max: 15}` |
| `src/infrastructure/config_manager.py:20` | `"wait_interval": 5` | `"wait_interval": {"min": 5, "max": 15}` |
| `README.md:303-305` | `{min: 8, max: 20}` | `{min: 5, max: 15}` (统一值) |
| `docs/guides/用户指南.md:50` | `{min: 5, max: 15}` | 保持不变 |
| `src/infrastructure/models.py:38-39` | `wait_interval_min: 8, wait_interval_max: 20` | 删除或更新 |

## 修改任务

### 1. 修改 config.example.yaml

将第10行：
```yaml
wait_interval: 5 # 搜索间隔（秒），建议 3-8
```

改为：
```yaml
wait_interval:
  min: 5  # 最小等待时间（秒）
  max: 15  # 最大等待时间（秒）
```

### 2. 修改 src/infrastructure/config_manager.py

将 DEFAULT_CONFIG 中的第20行：
```python
"wait_interval": 5,  # 简化为单个值
```

改为：
```python
"wait_interval": {"min": 5, "max": 15},
```

同时移除第239-246行的向后兼容转换代码（将dict转为int的逻辑），因为现在统一使用dict格式。

### 3. 修改 README.md

将第303-305行：
```yaml
wait_interval:
  min: 8              # 最小等待时间（秒）
  max: 20             # 最大等待时间（秒）
```

改为：
```yaml
wait_interval:
  min: 5              # 最小等待时间（秒）
  max: 15             # 最大等待时间（秒）
```

### 4. 检查 models.py

`src/infrastructure/models.py` 中的 `SearchConfig` 类有：
```python
wait_interval_min: int = 8
wait_interval_max: int = 20
```

这个类可能是备用定义，检查是否被使用。如果未被使用，可以删除这两个字段或更新默认值。

### 5. 更新 config_validator.py 中的验证逻辑

确保 `src/infrastructure/config_validator.py` 正确验证 dict 格式的 `wait_interval`。

## 验收标准

1. 运行 `ruff check .` 无错误
2. 运行 `pytest tests/unit/` 全部通过
3. 所有文档和配置文件中的 `wait_interval` 格式一致

## 工作目录

```
C:/Users/Disas/OneDrive/Desktop/my code/MS-Rewards-Automator-config
```

## 分支信息

- 分支名: `fix/config-consistency`
- 基于: `main` (c718a0e)
- 完成后: 创建 PR 合并到 main

## 注意事项

1. 不要修改 DEV_MODE_OVERRIDES 和 USER_MODE_OVERRIDES 中的 wait_interval 格式（它们已经是正确的 dict 格式）
2. 确保向后兼容：如果用户使用旧的单一值格式，应该给出警告或自动转换
3. 更新相关注释，确保中文注释与代码一致
